<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analyze DNA • simDNA</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analyze DNA">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simDNA</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/analyzeDNA.html">Analyze DNA</a>
    </li>
    <li>
      <a href="../articles/simulateDNA.html">simulateDNA</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Analyze DNA</h1>
            
      
      
      <div class="hidden name"><code>analyzeDNA.Rmd</code></div>

    </div>

    
    
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(simDNA)</code></pre></div>
<p>This vignette will explain more about using the package simDNA for analyzing DNA. For more information about simulating DNA using this package, please consult the simulateDNA vignette.</p>
<div id="functions-of-the-package" class="section level2">
<h2 class="hasAnchor">
<a href="#functions-of-the-package" class="anchor"></a>Functions of the package</h2>
<p>We will here give examples on how to use the different functions in the package as well as describe some of the theory behind.</p>
<div id="single-nucleotide-polymorphism-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#single-nucleotide-polymorphism-matrix" class="anchor"></a>Single-Nucleotide Polymorphism matrix</h3>
<p>The Single-Nucleotide Polymorphism (SNP) matrix is used to present DNA sequences in a compact manner, by only displaying positions on which one or more sequences has a mutation. It can be used to summarize DNA sequences where the sequence length is constant, which excludes i.e. sequences where insertions and deletions take place.</p>
<div id="example" class="section level4">
<h4 class="hasAnchor">
<a href="#example" class="anchor"></a>Example:</h4>
<p>The SNP matrix can be calculated using the function SNP</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">segSitesMat &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,
                        <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,
                        <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,
                        <span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dv">4</span>,<span class="dv">7</span>,<span class="dt">byrow=</span>T)
<span class="kw"><a href="../reference/SNP.html">SNP</a></span>(segSitesMat)
<span class="co">#&gt; $positions</span>
<span class="co">#&gt; [1] 2 3 5 7</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $SNPmat</span>
<span class="co">#&gt;      [,1] [,2] [,3] [,4]</span>
<span class="co">#&gt; [1,]    1    1    1    0</span>
<span class="co">#&gt; [2,]    0    1    0    1</span>
<span class="co">#&gt; [3,]    0    0    1    0</span>
<span class="co">#&gt; [4,]    0    1    0    1</span></code></pre></div>
</div>
</div>
<div id="site-frequency-spectrum" class="section level3">
<h3 class="hasAnchor">
<a href="#site-frequency-spectrum" class="anchor"></a>Site frequency spectrum</h3>
<p>The site frequency spectrum is often used for analyzing DNA. It can for instance be used to estimate the mutation rate and to give an indication of the population structure as we will show later.</p>
<p>The site frequency spectrum (SFS) is a summary statistic used for summarizing information about mutations. It is represented as the vector <span class="math inline">\(\xi = (\xi_1,...,\xi_{n-1})\)</span>, where <span class="math inline">\(n\)</span> is the number of samples and <span class="math inline">\(\xi_i\)</span> is the number of segregating sites where a mutation occur in <span class="math inline">\(i\)</span> sequences.</p>
<div id="example-1" class="section level4">
<h4 class="hasAnchor">
<a href="#example-1" class="anchor"></a>Example:</h4>
<p>The site frequency spectrum can be calculated using the function SFS.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/SFS.html">SFS</a></span>(segSitesMat)
<span class="co">#&gt; [1] 1 2 1</span></code></pre></div>
</div>
</div>
<div id="mutation-rate" class="section level3">
<h3 class="hasAnchor">
<a href="#mutation-rate" class="anchor"></a>Mutation rate</h3>
<p>There are many ways to estimate the mutation rate. We will here consider some estimators that are unbiased under the standard neutral coalescent model where we assume no natural selection, no recombination, constant population size and no subdivision (the population has not separated into two or more groups). These estimators can be used for more than just the standard neutral coalescent model, but are only guaranteed to be unbiased under that model. The estimators we consider are all based on the site frequency spectrum <span class="math inline">\(\xi\)</span> and the fact that <span class="math display">\[
E[\xi_i] = \frac{\theta}{i},
\]</span> where <span class="math inline">\(\theta\)</span> is the mutation rate. Thus <span class="math inline">\(i\xi_i,\ i=1,...,n-1\)</span> are all unbiased estimators of <span class="math inline">\(\theta\)</span>.</p>
<div id="wattersons-estimator" class="section level4">
<h4 class="hasAnchor">
<a href="#wattersons-estimator" class="anchor"></a>Watterson’s estimator</h4>
<p>A commonly used estimator for the mutation rate is Watterson’s estimator which is defined as <span class="math display">\[
\hat{\theta}_w = \frac{\sum_{i=1}^{n-1} \xi_i}{\sum_{i=1}^{n-1} \frac1i}.
\]</span> This is an unbiased estimator and consistent. That is, it has mean <span class="math inline">\(\theta\)</span>, and as the sample size approaches infinity, the variance approaches 0.</p>
</div>
<div id="pairwise-difference-estimator" class="section level4">
<h4 class="hasAnchor">
<a href="#pairwise-difference-estimator" class="anchor"></a>Pairwise difference estimator</h4>
<p>Another unbiased estimator is the pairwise difference. The pairwise difference is defined as <span class="math display">\[
\hat{\theta}_{\pi} = \frac{1}{{n \choose 2}} \sum_{i=1}^{n-1}i(n-i)\xi_i.
\]</span> While this estimator is unbiased, it is not consistent as the variance converges to <span class="math inline">\(\frac\theta3 + \frac29 \theta^2\)</span> as the sample size approaches infinity. Consistency in an estimator is often a property that one wishes for in an estimator, but despite this, the pairwise difference estimator is often used as an estimator for the mutation rate.</p>
</div>
<div id="example-2" class="section level4">
<h4 class="hasAnchor">
<a href="#example-2" class="anchor"></a>Example:</h4>
<p>Watterson’s estimator and the pairwise difference estimator can be calculated using the function mutRate.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/mutRate.html">mutRate</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>))
<span class="co">#&gt; $Watterson</span>
<span class="co">#&gt; [1] 1.5427</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $pairwDiff</span>
<span class="co">#&gt; [1] 1.464286</span></code></pre></div>
</div>
</div>
<div id="tajimas-d" class="section level3">
<h3 class="hasAnchor">
<a href="#tajimas-d" class="anchor"></a>Tajima’s D</h3>
<p>Tajima’s D is defined as <span class="math display">\[
D = \frac{\hat{\theta}_\pi - \hat{\theta}_w}{\sqrt{\widehat{\text{Var}}(\hat{\theta}_\pi - \hat{\theta}_w)}}
\]</span> and is used to test neutrality. That is, to test if the assumptions under the standard neutral coalescent model are reasonable.</p>
<p>If <span class="math inline">\(D \approx 0\)</span>, it would indicate that the standard neutral model is reasonable.</p>
<p>If <span class="math inline">\(D&lt;&lt;0\)</span>, it could be an indication of a growing population size, either a sudden expansion or an exponentially growing population.</p>
<p>If <span class="math inline">\(D&gt;&gt;0\)</span>, it could indicate population subdivision.</p>
<p>One often say that <span class="math inline">\(D\)</span> deviates significantly from 0 if <span class="math inline">\(D\)</span> is less than -2 or greater than +2.</p>
</div>
<div id="example-3" class="section level3">
<h3 class="hasAnchor">
<a href="#example-3" class="anchor"></a>Example:</h3>
<p>Tajima’s D can be calculated with the function TajimaD.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/TajimaD.html">TajimaD</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>))
<span class="co">#&gt; [1] 0.1587498</span></code></pre></div>
</div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Wakeley J. (2009) <em>Coalescent Theory: An Introduction</em>. Colorado: Roberts and Company Publishers.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#functions-of-the-package">Functions of the package</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by .</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
